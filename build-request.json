{
  "kind": "build_request",
  "title": "Add status change controls for client-facing task items",
  "projectName": "FINPROLEDGE Compliance",
  "priority": "normal",
  "requirements": [
    {
      "id": "REQ-1",
      "text": "In the MyComplianceTasksSection component, add inline status-change controls (select dropdowns or segmented buttons) for each task type — To-Dos, Timelines, Follow-Ups, and Deadlines — so that clients can update the status of their own tasks directly from the compliance dashboard. Each control should reflect the current status and immediately call the appropriate mutation hook on change (e.g., useUpdateClientToDoStatus, useUpdateClientTimelineStatus, useUpdateClientFollowUpStatus, useUpdateClientDeadlineStatus or equivalent hooks). Show a toast notification on success or failure.",
      "target": "frontend",
      "source": {
        "messageIds": [
          "msg-6"
        ],
        "quotes": [
          "provide a Way to change Status"
        ]
      },
      "acceptanceCriteria": [
        "Each task row in the My Compliance Tasks section (To-Dos, Timelines, Follow-Ups, Deadlines tabs) displays a status selector showing the current status.",
        "Selecting a new status triggers the correct backend mutation for that task type.",
        "A success toast is shown when the status is updated successfully.",
        "An error toast is shown if the update fails.",
        "The status badge/selector updates optimistically or refreshes after mutation completes."
      ]
    },
    {
      "id": "REQ-2",
      "text": "In the ClientTasksTab component, add the same inline status-change controls for each task type (To-Dos, Timelines, Follow-Ups, Deadlines) in the respective tab tables, so clients can update task statuses from the client portal as well. Reuse or share the status select logic from MyComplianceTasksSection to keep behavior consistent.",
      "target": "frontend",
      "source": {
        "messageIds": [
          "msg-6"
        ],
        "quotes": [
          "provide a Way to change Status"
        ]
      },
      "acceptanceCriteria": [
        "Each task table in ClientTasksTab includes a status selector per row for all four task types.",
        "The status options match the valid statuses defined in the backend types for each task.",
        "Changing the status calls the correct mutation and shows feedback toasts.",
        "Newly created tasks show the status control immediately without requiring a page reload."
      ]
    },
    {
      "id": "REQ-3",
      "text": "Ensure the backend actor exposes update-status endpoints for all four client task types (clientToDo, clientTimeline, clientFollowUp, clientDeadline) if they do not already exist. Each endpoint should accept the task ID and new status, verify the caller owns the record, and persist the updated status. Add or extend the corresponding frontend mutation hooks (e.g., in useComplianceAdmin.ts or a dedicated client-task hooks file) to call these endpoints.",
      "target": "both",
      "source": {
        "messageIds": [
          "msg-6"
        ],
        "quotes": [
          "provide a Way to change Status"
        ]
      },
      "acceptanceCriteria": [
        "Backend exposes updateClientToDoStatus, updateClientTimelineStatus, updateClientFollowUpStatus, and updateClientDeadlineStatus (or equivalent) methods.",
        "Each method validates that the calling principal owns the task before allowing the update.",
        "Frontend mutation hooks exist for each of the four task-type status updates.",
        "Hooks invalidate the relevant query cache keys upon success so the UI reflects the new status."
      ]
    }
  ],
  "constraints": [
    "Do not modify files under frontend/src/hooks/useActor.ts, frontend/src/hooks/useInternetIdentity.ts, frontend/src/main.tsx, or frontend/src/components/ui.",
    "Reuse existing TaskStatusSelect pattern (frontend/src/components/TaskStatusSelect.tsx) as the base for client-facing status selectors where applicable.",
    "Only the task owner (by principal) should be permitted to change their own task status on the backend."
  ],
  "nonGoals": [
    "Admin-side status changes are already handled by TaskStatusSelect and ComplianceAdmin components — do not duplicate or replace that logic.",
    "Do not add new task types beyond To-Dos, Timelines, Follow-Ups, and Deadlines.",
    "Do not redesign the overall layout of MyComplianceTasksSection or ClientTasksTab."
  ],
  "imageRequirements": {
    "required": [],
    "edits": []
  }
}